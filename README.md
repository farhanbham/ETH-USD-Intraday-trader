# Long-Short-Term-Memory (LSTM) Forecasting for Buy Signal Generation

> Task: Maximise Sharpe ratio using buy signals generated from our LSTM model.

In this project we attempt to generate buy signals by using an LSTM to predict the price in 24 hours using the last 24 hours of data. LSTM models are effective time series modellers due to their ability to capture temporal dependecies and handle non-stationary sequential data. Our buy signals are generated by comparing the forecasted price against the current price, producing a buy signal when the forecasted price is above a certain threshold relative to the current price. Finally, we evalaute our model using the Sharpe ratio and comparing it to a baseline buy and hold strategy. 


---


## Table of contents
- [Dataset](#dataset)
- [Data Preprocessing](#data-preprocessing)
- [LSTM Model](#lstm-model)
- [Forecast Evaluation](#forecast-evaluation)
- [Trading System](#trading-system)
- [Trading System Evaluation](#trading-system-evaluation)
- [Conclusion](#conclusion)


--


## Dataset

The dataset was downloaded using Binance's API. The dataset consists of hourly ETH-USD open, high, low, close and volume (OHLCV) data. The dataset has no missing values. 


---


## Data Preprocessing

We take several steps for processing our data to be used in our LSTM model:

**Scaling**
When scaling we ensure we scale our test data with parameters used to scale our training data. This is to ensure no data leakage leading to biased estimates. 

**Creating Sequences**
Our LSTM model requires batches of sequences for training. We create sequences of data including OHLCV data in which the length can be adjusted through the variable SEQ_LENGTH. A corresponding target value, the close price in 24 hours, is also created. 

**Auto-Encoder**
To prevent overfitting, we implement an autoencoder model. This reduces the dimensionality of our data to a specified dimension which can adjusted through the dimension variable. This model encodes the sequences into our specificied dimensionality and then decodes it. Although we already have our encoded data, we still need to decode it. This is so we can identify if encoded data retains meaningful information. We optimise our autoencoder model hyperparameters using Bayesian optimisation. This method learns from previous results in an attempt to reduce hyperparamter tuning speed as this is a time-intensive process.


---


## LSTM Model

Our LSTM model contains bi-directional, dropout and batch normalisation layers. The model hyperparamters are also tuned using bayesian optimisation. The model takes our encoded sequences as input, and trains using the target prices. Training and validation data is split in a 4:1 ratio. The Model uses mean squared error (MSE) as its loss function, penalising larger error more harshly than mean absolute error. After training, the model predicts prices using unseen data which will be used for our trading simulation.


---


## Forecast Evaluation


We evalaute the models forecasting performance using MSE, mean aboslute error (MAE) and mean absolute percentage error (MAPE). We also compare the models ability to forecasting the direction of price movement. We produce a confusion matrix and calculate recall (percentage of correctly predicted upward movements) and specificity (percentage of correctly predicted downward movements) scores. 


---


## Trading System

Here we create a trading system which buys, sells or holds its position every hour. Trades are made on the hourly ETH-USD close prices from January 2023 to June 2024. A slippage value of 0.0015 (0.15%) is applied to every trade to account for Binance's trading fee (0.1%) and margin loss (we estimate 0.05%). 

**Buy Signal**

We generate a buy signal by dividing the predicted price by the current price. If this value is above a certain threshold (eg. 1.04 or 4%) a buy signal is produced and the asset is purchased at the current price in the simulation if funds are available. 

**Sell Signal**

Our trading system sells when our position has increased by a certain threshold or if we have an open position beyond a certain maximum holding period. 

We are able to adjust position size, take_profit, max_hold_time and signal_strength parameter values.


---


## Trading System Evaluation

Our trading system is evaluated using annual return, maximum drawdown and the Sharpe ratio. These metrics are compared to a buy and hold strategy. The risk free rate used to calcualte the Sharpe ratio was estiamted to be the average 1 year treasury bond yield during the trading period.


---


## Conclusion

We find that the LSTM model appears to predict the future price of Ethereum farily accurately, however, this is due to the fact that the LSTM uses data from the previous 24 hour preiod. The model will therefore select prices close to the last seen price by the model. Furthermore, we find that the model is actually a poor estimator of price movement as seen through our confusion matrix and corresponding metrics. As the model is not effective in predicting the movement in price it cannot be considered a possible candidate for fianncial time series forecasting. However, the model does show promising results as it produces better metrics accross the board compared to our baseline model. This may be attributed to our signal generation threshold. If we create strict criteria for signal generation (a predicted price much greater than current price) this may increase the validity of the signals produced by our model. We suggest that further research include an implementation of other deep learning buy signal generation methods supplemented with those produced by our model.
  
